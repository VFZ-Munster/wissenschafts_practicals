load("C:/Users/aiswa/OneDrive/Desktop/R Data/Exersice1.RData")
as.factor(jobstat_lwk)
as.factor(NHANES1$jobstat_lwk)
NHANES1$jobstat_lwk <- as.factor(NHANES1$jobstat_lwk)
is.factor(NHANES1$jobstat_lwk)
as.factor(NHANES1$alc_lft)
NHANES1$alc_lft <- as.factor(NHANES1$alc_lft)
as.factor(NHANES1$smokstat)
NHANES1$smokstat <- as.factor(NHANES1$smokstat)
as.factor(NHANES1$milk_month)
NHANES1$milk_month <- as.factor(NHANES1$milk_month)
as.factor(NHANES1$phq1)
NHANES1$phq1 <- as.factor(NHANES1$phq1)
as.factor(NHANES1$phq2)
NHANES1$phq2 <- as.factor(NHANES1$phq2)
as.factor(NHANES1$phq3)
NHANES1$phq3 <- as.factor(NHANES1$phq3)
as.factor(NHANES1$phq4)
NHANES1$phq4 <- as.factor(NHANES1$phq4)
as.factor(NHANES1$phq5)
NHANES1$phq5 <- as.factor(NHANES1$phq5)
as.factor(NHANES1$phq6)
NHANES1$phq6 <- as.factor(NHANES1$phq6)
as.factor(NHANES1$phq7)
NHANES1$phq7 <- as.factor(NHANES1$phq7)
as.factor(NHANES1$phq8)
NHANES1$phq8 <- as.factor(NHANES1$phq8)
as.factor(NHANES1$phq9)
NHANES1$phq9 <- as.factor(NHANES1$phq9)
save.image("C:/Users/aiswa/OneDrive/Desktop/R Data/Ex.RData")
load("C:/Users/aiswa/OneDrive/Desktop/R Data/Ex.RData")
attach(NHANES1)
attach(male)
attach(NHANES1$male)
NHANES1$male
sum(NHNAES1$male,na.rm == "false")
sum(NHANES1$male,na.rm == "false")
sum(NHANES1$male=="FALSE")
sum(NHANES1$male=="TRUE")
mean(bmi)
mean(bmi, na.rm=T)
mean(bmi, na.rm=T,NHANES1$male="FALSE")
mean(bmi, na.rm=T,NHANES1$male=="FALSE")
mean(NHANES1$male=="FALSE", bmi, na.rm=T)
NHANES1$male
NHANES1$male=="TRUE"
mean(bmi, NHANES1$male=="TRUE")
summary(NHANES1)
data("iris")
data(iris)
install.packages("tidyverse")
q()
install.packages("data.table")
library(data.table)
data <- data.frame(PatientID = 1:19,
Baseline = c(0.8451, 0.69897, 1.36173, 1.54407, 1.04139, 1.07918, 0.84510, 2.50243, 2.20412, 0.90309, 1.30103, 1.04139, 1.38021, 1.53148, 1.73239, 1.47712, 1.0000, 1.30103, 1.07918),
AfterTreat = c(0.60206, 1.41497, 1.20412, 1.60206, 1.14613, 1.20412, 1.04139, 2.63749, 1.41497, 0.84510, 1.65321, 1.50515, 1.90309, 1.53148, 1.57978, 1.75587, 0.84510, 0.0000, 0.90309),
Rand = c(1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1))
View(data)
head(data)
t.test(x = data$Baseline[data$Rand == 1], y = data$AfterTreat[data$Rand == 1], paired=TRUE)
t.test(x = data$Baseline[data$Rand == 0], y = data$AfterTreat[data$Rand == 0], paired=TRUE)
t.test(x = data$AfterTreat[data$Rand == 1], y = data$AfterTreat[data$Rand == 0])
t.test(x = data$AfterTreat[data$Rand == 1], y = data$AfterTreat[data$Rand == 0],
var.equal = TRUE)
qt(0.975, df = 17)
t.test(x = (data$AfterTreat - data$Baseline)[data$Rand == 1],
y = (data$AfterTreat - data$Baseline)[data$Rand == 0],
var.equal = TRUE)
qt(0.975, df = 17)
model <- lm(AfterTreat ~ Baseline + Rand, data = data)
summary(model)
library(ieugwasr)
#Loading the necsessary libraries
library(tidyverse)
install.packages(c("brew", "callr", "checkmate", "commonmark", "cowplot", "curl", "data.table", "DBI", "deldir", "filelock", "future", "future.apply", "gert", "GGally", "ggforce", "ggplot2", "ggridges", "httpuv", "interp", "kableExtra", "listenv", "lubridate", "markdown", "Matrix", "matrixStats", "mets", "mgcv", "mosaic", "ordinal", "parallelly", "patchwork", "R.oo", "ragg", "RcppArmadillo", "RcppEigen", "RCurl", "renv", "reprex", "riskRegression", "robustbase", "roxygen2", "rsconnect", "RSQLite", "rvest", "sandwich", "shape", "survival", "svglite", "tidyr", "timechange", "TMB", "tweenr", "ucminf", "unmarked", "usethis", "uuid", "VGAM", "viridis", "xfun", "XML", "zip"))
install.packages("installr")
library(installr)
updateR()
updateR()
library(knitr)
library(dplyr)
library(survival)
library(ggplot2)
library(tibble)
install.packages("survival")
install.packages("survival")
library(survival)
t <- c(1.8, 2.2, 2.5,
2.6,
3.5,
3.8,
5.3,
5.4,
6.6,
8.2,
8.7,
9.2,
9.8,
10.2,
10.7,
11.0,
11.1,
11.7
)
failures <- c(1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
2,
1,
1,
1,
1,
1,
1,
)
failures <- c(1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
2,
1,
1,
1,
1,
1,
1,
)
failures <- c(1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
1,
2,
1,
1,
1,
1,
1,
1
)
surv_object <- Surv(t, event = failures, type = "right")
km_fit <- survfit(surv_object ~ 1)
plot(km_fit, col = "blue", mark.time = FALSE, xlab = "Time (months)", ylab = "Survival Probability", main = "Kaplan-Meier Survival Curve")
View(km_fit)
View(km_fit)
library(readxl)
X <- read_excel("C:/Users/aiswa/OneDrive/Desktop/X.xlsx")
View(X)
A <- Surv(time = X$`t(f)`, event = X$`m(f)`, type = "right")
A
summary(A)
A <- Surv(time = X$`t(f)`, event = X$`m(f)`)
A
summary(A)
W <- survfit2(Surv(X$`t(f)`, X$`m(f)`) ~ 1, data = X) %>%
gsurvfit() +
labs(
x = "Months",
y = "Overall survival probability"
)
W <- survfit(Surv(X$`t(f)`, X$`m(f)`) ~ 1, data = X) %>%
gsurvfit() +
labs(
x = "Months",
y = "Overall survival probability"
)
install.packages("ggsurvfit")
library(ggsurvfit)
library(broom)
Wy <- survfit(Surv(X$`t(f)`, X$`m(f)`~ 1))
View(X)
Wy <- survfit(Surv(X$`t(f)`, X$`m(f)`~ 1, data = X))
is.numeric(X$`m(f)`)
surv_object <- Surv(X$`t(f)`, event = X$`m(f)`, type = "right")
# Fit Kaplan-Meier model
km_fit <- survfit(surv_object ~ 1)
# Plot Kaplan-Meier curve without + sign for right-censored observations
plot(km_fit, col = "blue", mark.time = FALSE, xlab = "Time (months)", ylab = "Survival Probability", main = "Kaplan-Meier Survival Curve", mark.time=FALSE)
# Plot Kaplan-Meier curve without + sign for right-censored observations
plot(km_fit, col = "blue", xlab = "Time (months)", ylab = "Survival Probability", main = "Kaplan-Meier Survival Curve", mark.time=FALSE)
View(X)
library(readxl)
X <- read_excel("C:/Users/aiswa/OneDrive/Desktop/X.xlsx")
View(X)
surv_object <- Surv(X$`t(f)`, event = X$`m(f)`, type = "right")
View(km_fit)
View(X)
# Fit Kaplan-Meier model
km_fit <- survfit(surv_object ~ 1)
# Plot Kaplan-Meier curve without + sign for right-censored observations
plot(km_fit, col = "blue", xlab = "Time (months)", ylab = "Survival Probability", main = "Kaplan-Meier Survival Curve", mark.time=FALSE)
# Plot Kaplan-Meier curve without + sign for right-censored observations
plot(km_fit, col = "blue", xlab = "Time (months)", ylab = "Survival Probability", main = "Kaplan-Meier Survival Curve", mark.time=FALSE)
months <- c(1.8,
2.2,
2.5,
2.6,
3.5,
3.8,
5.3,
5.4,
6.6,
8.2,
8.7,
9.2,
9.8,
10.2,
10.7,
11.0,
11.1,
11.7
)
S <- c(0.96,
0.92,
0.88,
0.84,
0.8,
0.76,
0.72,
0.68,
0.64,
0.59,
0.54,
0.45,
0.40,
0.36,
0.31,
0.26,
0.21,
0.16
)
plot(months, S, xlab = "Months", ylab = "Survival probability", main = "Plot")
F <-step_fun(months, S)
surv_obj <- Surv(time = months, event = rep(1,length(months)), type = "right")
km_fit <- survfit(surv_obj ~ 1, surv = S)
library(readr)
actg320 <- read_table("C:/Users/aiswa/OneDrive/Desktop/LMU/Biometry/Survival Analysis/actg320.txt")
View(actg320)
library(survival)
install.packages("survminer")
library(survminer)
ox_model <- coxph(Surv(time, status) ~ cd4_group, data = actg320)
ox_model <- coxph(Surv(time, event) ~ cd4_group, data = actg320)
ox_model <- coxph(Surv(time, actg320$"event") ~ cd4_group, data = actg320)
ox_model <- coxph(Surv(time, actg320$`"event"`) ~ cd4_group, data = actg320)
ox_model <- coxph(Surv(actg320$`"time"`, actg320$`"event"`) ~ cd4_group, data = actg320)
View(actg320)
gsurvplot(survfit(ox_model, newdata = actg320), data = actg320, risk.table = TRUE,
pval = TRUE, conf.int = TRUE, legend.title = "CD4 Group",
xlab = "Time (days)", ylab = "Survival Probability",
title = "Log-log Survival Curves for CD4 Group")
ggsurvplot(survfit(ox_model, newdata = actg320), data = actg320, risk.table = TRUE,
pval = TRUE, conf.int = TRUE, legend.title = "CD4 Group",
xlab = "Time (days)", ylab = "Survival Probability",
title = "Log-log Survival Curves for CD4 Group")
ox_model <- coxph(Surv(actg320$`"time"`, actg320$`"event"`) ~ cd4_group, data = actg320)
View(actg320)
ieugwasr::get_opengwas_jwt()
ieugwasr::user(opengwas_jwt = get_opengwas_jwt())
ieugwasr::user(opengwas_jwt = get_opengwas_jwt())
library(ieugwasr)
library(dplyr)
ieugwasr::user(opengwas_jwt = get_opengwas_jwt())
library(readr)
FF4_anxiety_hg19_MRIsample <- read_delim("D:/data_aiswarya/geneticData/FF4_anxiety_hg19_MRIsample.txt",
delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(FF4_anxiety_hg19_MRIsample)
library(readr)
FF4_backpain_hg19_MRIsample <- read_delim("D:/data_aiswarya/geneticData/FF4_backpain_hg19_MRIsample.txt",
delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(FF4_backpain_hg19_MRIsample)
library(readr)
ibrary(tidyverse)
library(tidyverse)
library(dplyr)
library(data.table)
library(biomaRt)
library(ieugwasr)
library(TwoSampleMR)
library(ggplot2)
library(proxysnps)
library(LDlinkR)
Stroke_FG<- read_tsv("C:/Users/aiswa/Downloads/summary_stats_release_finngen_R12_I9_STR/summary_stats_release_finngen_R12_I9_STR.tsv")
colnames(Stroke_FG)
#----Diazoxide----
KCNJ11_SigSNPs <- read.table("D:/Antihypertensives_DC/VH/clump_KCNJ11_hg19.txt", sep = "\t", header = TRUE) %>% rename(rsids = "rsid")
setDT(KCNJ11_SigSNPs)
setDT(Stroke_FG)
Stroke <- merge(KCNJ11_SigSNPs[, .(rsids, Chr, Pos)],
Stroke_FG[, .(ref, alt, rsids, nearest_genes, beta, sebeta, af_alt, pval)],
by = "rsids") %>%
mutate(samplesize = 484133)
Stroke #15 SNPs
missing_SNP <- setdiff(KCNJ11_SigSNPs$rsids, Stroke$rsids)
missing_SNP
KCNJ11_SigSNPs <- as.data.frame(KCNJ11_SigSNPs)
DZ_SBP <- format_data(KCNJ11_SigSNPs,
type = "exposure",
header = TRUE,
snp_col = "rsids",
beta_col = "beta",
se_col = "standard_error",
eaf_col = "effect_allele_frequency",
effect_allele_col = "effect_allele",
other_allele_col = "other_allele",
pval_col = "pval",
samplesize_col = "n",
chr_col = "Chr",
gene_col = "Gene",
pos_col = "Pos") %>%
mutate(id.exposure = "KCNJ11 gene", exposure = "KCNJ11 gene")
View(DZ_SBP)
Stroke <- as.data.frame(Stroke)
Stroke_DZ <- format_data(Stroke,
type = "outcome",
header = TRUE,
phenotype_col = "outcome",
snp_col = "rsids",
beta_col = "beta",
se_col = "sebeta",
eaf_col = "af_alt",
effect_allele_col = "alt",
other_allele_col = "ref",
pval_col = "pval",
samplesize_col = "samplesize",
id_col = "outcome",
chr_col = "Chr",
pos_col = "Pos") %>%
mutate(outcome = "Stroke", id.outcome = "Stroke")
DZ_Stroke<- harmonise_data(DZ_SBP, Stroke_DZ)
DZ_Stroke
#rs10832778, rs66906527 removed for being palindromic with intermediate allele frequencies
write.table(DZ_CHD, file = "D:/Antihypertensives_DC/VH/Stroke/Diazoxide/DZ_Stroke.txt", sep = "\t", col.names = TRUE, row.names = FALSE)
#rs10832778, rs66906527 removed for being palindromic with intermediate allele frequencies
write.table(DZ_Stroke, file = "D:/Antihypertensives_DC/VH/Stroke/Diazoxide/DZ_Stroke.txt", sep = "\t", col.names = TRUE, row.names = FALSE)
table(sign(DZ_Stroke$beta.exposure)==sign(DZ_Stroke$beta.outcome)) #5 false, 10 true
MR_DZ_Stroke<- mr(DZ_Stroke, method_list= c("mr_ivw_mre","mr_ivw_fe","mr_ivw")) %>%
dplyr::select(id.exposure,id.outcome,nsnp,method,b,se,pval)
MR_DZ_Stroke
#positive effect estimate, insignificant p-value
write.table(MR_DZ_Stroke, file = "D:/Antihypertensives_DC/VH/Stroke/Diazoxide/MR_DZ_Stroke.txt", sep = "\t", col.names = TRUE, row.names = FALSE)
MR_DZ_Stroke$DE<- -(MR_DZ_Stroke$b)
#Calculating OR as the outcome is binary
MR_DZ_Stroke$OR <- round(exp(MR_DZ_Stroke$DE),3)
MR_DZ_Stroke$OR_CI <- paste("(",round(exp(MR_DZ_Stroke$DE-1.96*MR_DZ_Stroke$se),3),";",round(exp(MR_DZ_Stroke$DE+1.96*MR_DZ_Stroke$se),3),")",sep="")
MR_DZ_Stroke_OR <- MR_DZ_Stroke %>%
dplyr::select(id.exposure,id.outcome,method,
nsnp,OR, OR_CI, pval) %>%
mutate(id.exposure = "Genetically proxied pharamcological action of Diazoxide", pval = round(pval, 3))
MR_DZ_Stroke_OR
#OR < 1, insignificant p-value. The direction of effect estimate is as expected.
write.table(MR_DZ_Stroke_OR, file = "D:/Antihypertensives_DC/VH/Stroke/Diazoxide/MR_DZ_Stroke_ORDE.txt", sep = "\t", col.names = TRUE, row.names = FALSE)
View(KCNJ11_SigSNPs)
setwd("C:/Users/aiswa/OneDrive/Desktop/website_practicals/praktikum 4")
system("quarto render --profile english")
system("quarto render --profile german")
system("quarto preview")
system("quarto render --profile english")
system("quarto render --profile german")
system("quarto preview")
