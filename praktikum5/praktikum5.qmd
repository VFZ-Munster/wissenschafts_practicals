::: {.content-visible when-profile="english"}
# Practical 5
:::

::: {.content-visible when-profile="german"}
# Praktikum 5
:::

::: {.content-visible when-profile="english"}
## Exercise 1: Univariable Analysis

### Exercise 1.1 Dummy Variables

Build a univariable linear regression model to study the association between smoking (`smk`; 1=Never, 2=Former, 3=Current, set the never smokers as a reference group) and attachment loss (`cal_mean`; in mm).

Since the smoking variable has three levels, the first step is to create dummy variables.

**1. Create a dummy variable for "Former" smokers:**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Transform</span>
  <span class="arrow">â†’</span>
  <span class="step">Recode into Different Variables</span>
</div>

<span class="text-steps">Step 2: </span> Select `smk` >> write `Former` under Name & Label >> press Change.

<span class="text-steps">Step 3: </span> Click "Old and New Values".

<span class="text-steps">Step 4: </span> Configure values:

- Under **Old Value**: enter `2` >> Under **New Value**: enter `1` >> Press **Add**.
- Under **Old Value**: enter `1` >> Under **New Value**: enter `0` >> Press **Add**.
- Under **Old Value**: enter `3` >> Under **New Value**: enter `0` >> Press **Add**.
- Under **Old Value**: select **System- or user-missing** >> Under **New Value**: select **System-missing** >> Press **Add**.
- Select **All other values** >> select **Copy old value(s)** >> Press **Add**. (This handles missing values)

**Note:** Ensure `Measure` is Nominal in Variable View, Decimals is set to 0, and Change Values to 0 = "Current/none" and 1 = "Former".

<details>

<summary><img alt="Static Badge" src="https://img.shields.io/badge/Task-Results-green"></summary>

<video width="640" height="480" controls style="margin-top: 20px; display: block;">
  <source src="video1.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>

</details>

**2. Repeat the same procedure to create a dummy variable for "Current" smokers.** 
(Recode `smk`: 3 -> 1, 1 -> 0, 2 -> 0).

**3. Fit the model**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Analyze</span>
  <span class="arrow">â†’</span>
  <span class="step">Regression</span>
  <span class="arrow">â†’</span>
  <span class="step">Linear</span>
</div>

<span class="text-steps">Step 2: </span> Choose `cal_mean` as Dependent Variable.

<span class="text-steps">Step 3: </span> Choose `Former` and `Current` under Block 1 of 1 (Independent variables).

<details>

<summary><img alt="Static Badge" src="https://img.shields.io/badge/Formula-Time-red"></summary>

The linear regression model is defined as:

$$Y_i = \beta_0 + \beta_{former} X_i + \beta_{current} X_i + \epsilon_i$$

where $\beta_0$ is the intercept term and represents the value corresponding to the reference group or never smokers.

</details>

Based on the output, and considering never smokers as the reference group, do individuals who are currently smoking have higher `cal_mean` measurement than former smokers?: âœ… Interpret the results

<details>

<summary><img alt="Static Badge" src="https://img.shields.io/badge/Task-Results-green"></summary>

|Model | Meaning |Coefficient|p-value|Lower CI|Upper CI|Interpretation|
|---|-----------|---|---|---|---|--------------|
|(Constant)|mean CAL for never smokers |0.942|<0.001|0.913|0.971||
|Former|difference in mean CAL between former smokers and never smokers|0.339|<0.001|0.289|0.388|So former smokers have, on average, 0.34 units higher CAL than never smokers|
|Current |difference in mean CAL between current smokers and never smokers|0.519|<0.001|0.464|0.573|So current smokers have, on average, 0.52 units higher CAL than never smokers|

**Summarizing:**
Compared with never smokers, former smokers have about 0.34 higher mean clinical attachment loss, and current smokers have about 0.52 higher mean clinical attachment loss.

</details>

## Exercise 2: Linear Regression Assumptions

:::{.callout-tip title="Background"}
  By design:

  - We ensure that the observations are derived from independent participants. 
  - We ensure that the target variable of our model is normally distributed.

:::

### Exercise 2.1 Descriptive

Check whether `cal_mean` or `ln_loss` are normally distributed, graphically and statistically.

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Analyze</span>
  <span class="arrow">â†’</span>
  <span class="step">Descriptive statistics</span>
  <span class="arrow">â†’</span>
  <span class="step">Explore</span>
</div>

<span class="text-steps">Step 2: </span> Dependent list: `cal_mean` and `ln_loss`.

<span class="text-steps">Step 3: </span> Plots: Check Histogram and Normality plots with tests.

### Exercise 2.2 Linearity assumption

Check graphically the linearity assumption between `ln_loss` and other continuous variables (e.g. `alcg`).

**Create a scatter plot:**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Graphs</span>
  <span class="arrow">â†’</span>
  <span class="step">Chart Builder</span>
</div>

<span class="text-steps">Step 2: </span> Gallery >> Scatter/Dot >> Drag 'Simple Scatter' to preview.

<span class="text-steps">Step 3: </span> Y-axis: `ln_loss`.

<span class="text-steps">Step 4: </span> X-axis: `alcg` (independent).

**Add regression line:**
Double click graph >> Add Fit Line at Total >> Select Linear.

Create another graph for `height` and `weight`. Compare the two. Which one shows a linear relationship?

### Exercise 2.3 Polynomials

One way to deal with non-linearity is to introduce a quadratic expression.
For the relationship between `ln_loss` and `alcg`, add a quadratic term.

**Create quadratic term:**
Create new variable `alcg2` = `alcg` * `alcg`.

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Transform</span>
  <span class="arrow">â†’</span>
  <span class="step">Compute Variables</span>
</div>

<span class="text-steps">Step 2: </span> Target Variable: `alcg2`. Numeric Expression: `alcg * alcg`.

### Exercise 2.4 Homoscedasticity assumption

Check the homoscedasticity assumption graphically and statistically.

**Graphically:**
Run regression (`ln_loss` ~ `alcg`).
Generic setup:
- Statistics: Estimates, CI, Model fit, R squared change, Descriptives, Collinearity diagnostics.
- Plots: Y: `*ZRESID`, X: `*ZPRED`. Check Histogram and Normal probability plot.
- Check if residuals are randomly distributed.

**Statistically (Breusch-Pagan test):**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Analyze</span>
  <span class="arrow">â†’</span>
  <span class="step">General Linear Model</span>
  <span class="arrow">â†’</span>
  <span class="step">Univariate</span>
</div>

<span class="text-steps">Step 2: </span> Dependent Variable: `ln_loss`.

<span class="text-steps">Step 3: </span> Covariate(s): `alcg`.

<span class="text-steps">Step 4: </span> Options: Check **Breusch-Pagan test** (under Heteroskedasticity Tests) and **Parameter estimates with robust standard error** (HC3).

## Exercise 3: Effect Modification

### Exercise 3.1 Create an interaction term

We hypothesize that the impact of alcohol on attachment loss differs by gender.
Introduce an interaction term between gender (`sex`) and alcohol consumption (`alcg`).

**1. Create interaction variable (`AlcSex`):**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Transform</span>
  <span class="arrow">â†’</span>
  <span class="step">Compute variable</span>
</div>

<span class="text-steps">Step 2: </span> Target Variable: `AlcSex`

<span class="text-steps">Step 3: </span> Numeric Expression: `alcg * sex`

**2. Fit multivariable model:**

ðŸ’¡ SPSS:

<div class="instruction-flow">
  <span class="step">Analyze</span>
  <span class="arrow">â†’</span>
  <span class="step">Regression</span>
  <span class="arrow">â†’</span>
  <span class="step">Linear</span>
</div>

<span class="text-steps">Step 2: </span> Dependent: `attachment loss` (assuming `cal_mean` or `ln_loss` - usually consistent with previous steps, let's use `cal_mean` or as specified in your variables list).

<span class="text-steps">Step 3: </span> Independent: `alcg`, `AlcSex`. (Note: text says `Yi = B0 + B1*alcg + B2*Sex + B3*alcg*Sex`. So include `sex` too).

Equation: $Y_i = \beta_0 + \beta_1 alcg + \beta_2 Sex + \beta_3 alcg*Sex + \epsilon_i$

:::

